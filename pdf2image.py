import fitz
import os
import pathlib


class pdf2image:
    def mkdir(self, foldername):
        if not os.path.isdir(foldername):
            os.mkdir(foldername)

    def output(self, foldername, name):
        self.mkdir(self, foldername)
        return os.path.join(foldername, name)

    @classmethod
    def convert(self, filename):
        folder_name = filename.strip(".pdf")
        pdffile = filename
        doc = fitz.open(pdffile)
        for x in range(len(doc)):
            page = doc.load_page(0)  # number of page
            pix = page.get_pixmap()
            output = self.output(self, folder_name, f"outfile_{x}.png")
            pix.save(output)
        return str(pathlib.Path(folder_name).absolute())